{% extends "admin_login/base.html" %}

{% block title %}Admin Login - EduVerifi{% endblock %}

{% block content %}
<div class="header">
    <h1>Admin Login</h1>
    <p>Secure access to EduVerifi administration</p>
</div>

{% if messages %}
    <div class="messages">
        {% for message in messages %}
            <div class="message {{ message.tags }}">{{ message }}</div>
        {% endfor %}
    </div>
{% endif %}

{% if wizard.form.forms %}
    <!-- Multi-step form (for 2FA token entry) -->
    <form method="post">
        {% csrf_token %}
        {{ wizard.management_form }}
        
        {% if wizard.form.forms.0 %}
            <!-- Username/Password step -->
            <div class="form-group">
                <label for="{{ wizard.form.auth-username.id_for_label }}">Username</label>
                {{ wizard.form.forms.0.username }}
            </div>
            <div class="form-group">
                <label for="{{ wizard.form.auth-password.id_for_label }}">Password</label>
                {{ wizard.form.forms.0.password }}
            </div>
        {% endif %}
        
        {% if wizard.form.forms.1 %}
            <!-- Token step -->
            <div class="form-group">
                <label for="{{ wizard.form.token-otp_token.id_for_label }}">Authentication Code</label>
                {{ wizard.form.forms.1.otp_token }}
                <small>Enter the 6-digit code from your authenticator app</small>
            </div>
        {% endif %}
        
        <button type="submit" class="btn">
            {% if wizard.steps.current == 'auth' %}Login{% else %}Verify{% endif %}
        </button>
    </form>
{% else %}
    <!-- Single form -->
    <form method="post">
        {% csrf_token %}
        {{ wizard.management_form }}
        
        {% for field in wizard.form %}
            <div class="form-group">
                <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                {{ field }}
                {% if field.help_text %}
                    <small>{{ field.help_text }}</small>
                {% endif %}
                {% if field.errors %}
                    <div class="error">{{ field.errors }}</div>
                {% endif %}
            </div>
        {% endfor %}
        
        <button type="submit" class="btn">
            {% if wizard.steps.current == 'auth' %}Login{% else %}Verify{% endif %}
        </button>
    </form>
{% endif %}

<div class="notice">
    ðŸ”’ This login requires two-factor authentication for enhanced security.
</div>
{% endblock %}